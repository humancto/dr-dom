<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dr. DOM Test Page</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            padding: 40px;
            max-width: 1200px;
            margin: 0 auto;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }
        .container {
            background: white;
            border-radius: 12px;
            padding: 40px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
        }
        h1 {
            color: #333;
            margin-bottom: 30px;
        }
        .test-section {
            margin: 30px 0;
            padding: 20px;
            background: #f8f9fa;
            border-radius: 8px;
        }
        button {
            background: #667eea;
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 6px;
            font-size: 16px;
            cursor: pointer;
            margin: 5px;
        }
        button:hover {
            background: #5a67d8;
        }
        .error-btn {
            background: #e53e3e;
        }
        .error-btn:hover {
            background: #c53030;
        }
        #output {
            margin-top: 20px;
            padding: 20px;
            background: #1a202c;
            color: #10b981;
            border-radius: 8px;
            font-family: 'Monaco', 'Courier New', monospace;
            font-size: 14px;
            max-height: 400px;
            overflow-y: auto;
        }
        .status {
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 15px 25px;
            background: white;
            border-radius: 8px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
            font-weight: 600;
        }
        .status.ready {
            color: #10b981;
            border: 2px solid #10b981;
        }
        .status.loading {
            color: #f59e0b;
            border: 2px solid #f59e0b;
        }
        .component-list {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 15px;
            margin-top: 20px;
        }
        .component {
            padding: 15px;
            background: white;
            border-radius: 6px;
            border: 2px solid #e5e7eb;
        }
        .component.loaded {
            border-color: #10b981;
            background: #f0fdf4;
        }
        .component-name {
            font-weight: 600;
            margin-bottom: 5px;
        }
        .component-status {
            font-size: 14px;
            color: #6b7280;
        }
    </style>
</head>
<body>
    <div class="status loading" id="status">Dr. DOM Loading...</div>
    
    <div class="container">
        <h1>ğŸ” Dr. DOM Test Page</h1>
        <p>This page helps you test all Dr. DOM features. Open the Dr. DOM extension popup and click "Start Analysis" to begin monitoring.</p>
        
        <div class="test-section">
            <h2>ğŸ“Š Component Status</h2>
            <div class="component-list" id="components">
                <div class="component">
                    <div class="component-name">ğŸ¯ Coordinator</div>
                    <div class="component-status" id="coordinator-status">Checking...</div>
                </div>
                <div class="component">
                    <div class="component-name">ğŸŒ Advanced Network Monitor</div>
                    <div class="component-status" id="network-status">Checking...</div>
                </div>
                <div class="component">
                    <div class="component-name">ğŸ§  Intelligent Error Analyzer</div>
                    <div class="component-status" id="error-status">Checking...</div>
                </div>
                <div class="component">
                    <div class="component-name">ğŸ“ Smart Console Analyzer</div>
                    <div class="component-status" id="console-status">Checking...</div>
                </div>
                <div class="component">
                    <div class="component-name">ğŸ“ˆ Core Web Vitals Monitor</div>
                    <div class="component-status" id="vitals-status">Checking...</div>
                </div>
                <div class="component">
                    <div class="component-name">âš¡ Performance Monitor</div>
                    <div class="component-status" id="performance-status">Checking...</div>
                </div>
            </div>
        </div>
        
        <div class="test-section">
            <h2>ğŸ§ª Test Network Requests</h2>
            <button onclick="testFetch()">ğŸ“¡ Test Fetch API</button>
            <button onclick="testXHR()">ğŸ“Ÿ Test XMLHttpRequest</button>
            <button onclick="testMultiple()">ğŸš€ Test Multiple Requests</button>
            <button onclick="testSlow()">ğŸŒ Test Slow Request</button>
            <button onclick="testFailed()">âŒ Test Failed Request</button>
        </div>
        
        <div class="test-section">
            <h2>ğŸ› Test Error Handling</h2>
            <button class="error-btn" onclick="throwError()">ğŸ’¥ Throw JavaScript Error</button>
            <button class="error-btn" onclick="throwTypeError()">ğŸ”¤ Throw Type Error</button>
            <button class="error-btn" onclick="throwAsync()">â±ï¸ Throw Async Error</button>
            <button class="error-btn" onclick="consoleErrors()">ğŸ“ Console Errors</button>
        </div>
        
        <div class="test-section">
            <h2>ğŸ­ Test Console Messages</h2>
            <button onclick="testConsoleLog()">ğŸ“¢ Console Log</button>
            <button onclick="testConsoleWarn()">âš ï¸ Console Warn</button>
            <button onclick="testConsoleError()">ğŸš¨ Console Error</button>
            <button onclick="testConsoleSpam()">ğŸ“¨ Console Spam</button>
        </div>
        
        <div class="test-section">
            <h2>ğŸ¯ Test DOM Changes</h2>
            <button onclick="addElements()">â• Add 100 Elements</button>
            <button onclick="removeElements()">â– Remove Elements</button>
            <button onclick="modifyElements()">âœï¸ Modify Elements</button>
            <button onclick="causeLayoutShift()">ğŸ“ Cause Layout Shift</button>
        </div>
        
        <div id="output">
            <div>Ready to test Dr. DOM features...</div>
        </div>
        
        <div id="test-container" style="display: none;"></div>
    </div>
    
    <script>
        const output = document.getElementById('output');
        const statusEl = document.getElementById('status');
        
        function log(message, type = 'info') {
            const timestamp = new Date().toLocaleTimeString();
            const color = type === 'error' ? '#ef4444' : type === 'success' ? '#10b981' : '#64748b';
            output.innerHTML += `<div style="color: ${color}">[${timestamp}] ${message}</div>`;
            output.scrollTop = output.scrollHeight;
        }
        
        // Check Dr. DOM components
        function checkComponents() {
            const components = {
                'coordinator': window.drDOMCoordinator,
                'network': window.drDOMAdvancedNetworkMonitor,
                'error': window.drDOMIntelligentErrorAnalyzer,
                'console': window.drDOMSmartConsoleAnalyzer,
                'vitals': window.drDOMCoreWebVitalsMonitor,
                'performance': window.drDOMPerformanceMonitor
            };
            
            let allLoaded = true;
            
            for (const [key, component] of Object.entries(components)) {
                const statusEl = document.getElementById(`${key}-status`);
                const componentEl = statusEl.parentElement;
                
                if (component) {
                    statusEl.textContent = 'âœ… Loaded and Ready';
                    componentEl.classList.add('loaded');
                } else {
                    statusEl.textContent = 'â³ Not loaded';
                    allLoaded = false;
                }
            }
            
            if (allLoaded) {
                statusEl.textContent = 'âœ… Dr. DOM Ready';
                statusEl.className = 'status ready';
                log('All Dr. DOM components loaded successfully!', 'success');
            }
            
            return allLoaded;
        }
        
        // Check components on load
        setTimeout(checkComponents, 1000);
        setTimeout(checkComponents, 2000);
        setTimeout(checkComponents, 3000);
        
        // Test functions
        async function testFetch() {
            log('ğŸ” Testing Fetch API request...');
            try {
                const response = await fetch('https://jsonplaceholder.typicode.com/posts/1');
                const data = await response.json();
                log(`âœ… Fetch successful: Post ID ${data.id}`, 'success');
            } catch (error) {
                log(`âŒ Fetch failed: ${error.message}`, 'error');
            }
        }
        
        function testXHR() {
            log('ğŸ” Testing XMLHttpRequest...');
            const xhr = new XMLHttpRequest();
            xhr.open('GET', 'https://jsonplaceholder.typicode.com/users/1');
            xhr.onload = function() {
                if (xhr.status === 200) {
                    const data = JSON.parse(xhr.responseText);
                    log(`âœ… XHR successful: User ${data.name}`, 'success');
                }
            };
            xhr.onerror = function() {
                log('âŒ XHR failed', 'error');
            };
            xhr.send();
        }
        
        async function testMultiple() {
            log('ğŸ” Testing multiple concurrent requests...');
            const urls = [
                'https://jsonplaceholder.typicode.com/posts/1',
                'https://jsonplaceholder.typicode.com/posts/2',
                'https://jsonplaceholder.typicode.com/posts/3',
                'https://jsonplaceholder.typicode.com/users/1',
                'https://jsonplaceholder.typicode.com/comments/1'
            ];
            
            Promise.all(urls.map(url => fetch(url)))
                .then(responses => {
                    log(`âœ… All ${responses.length} requests completed`, 'success');
                })
                .catch(error => {
                    log(`âŒ Multiple requests failed: ${error.message}`, 'error');
                });
        }
        
        async function testSlow() {
            log('ğŸ” Testing slow request (3 second delay)...');
            try {
                const response = await fetch('https://httpbin.org/delay/3');
                log('âœ… Slow request completed', 'success');
            } catch (error) {
                log(`âŒ Slow request failed: ${error.message}`, 'error');
            }
        }
        
        async function testFailed() {
            log('ğŸ” Testing failed request (404)...');
            try {
                const response = await fetch('https://jsonplaceholder.typicode.com/posts/999999');
                if (!response.ok) {
                    log(`âš ï¸ Request returned ${response.status} ${response.statusText}`, 'error');
                }
            } catch (error) {
                log(`âŒ Request failed: ${error.message}`, 'error');
            }
        }
        
        function throwError() {
            log('ğŸ’¥ Throwing JavaScript error...');
            throw new Error('Test error from Dr. DOM test page!');
        }
        
        function throwTypeError() {
            log('ğŸ’¥ Throwing Type error...');
            null.someMethod(); // This will throw a TypeError
        }
        
        function throwAsync() {
            log('ğŸ’¥ Throwing async error in 1 second...');
            setTimeout(() => {
                throw new Error('Async error from setTimeout!');
            }, 1000);
        }
        
        function consoleErrors() {
            console.error('Test console error 1');
            console.error('Test console error 2');
            console.warn('Test console warning');
            log('ğŸ“ Sent errors and warnings to console');
        }
        
        function testConsoleLog() {
            console.log('Test log message:', { data: 'test', timestamp: Date.now() });
            log('ğŸ“¢ Sent log to console');
        }
        
        function testConsoleWarn() {
            console.warn('Warning: This is a test warning from Dr. DOM');
            log('âš ï¸ Sent warning to console');
        }
        
        function testConsoleError() {
            console.error('Error: This is a test error from Dr. DOM');
            log('ğŸš¨ Sent error to console');
        }
        
        function testConsoleSpam() {
            log('ğŸ“¨ Spamming console with 50 messages...');
            for (let i = 0; i < 50; i++) {
                console.log(`Spam message ${i + 1}`);
            }
            log('âœ… Spam complete - check if Dr. DOM detected it', 'success');
        }
        
        function addElements() {
            const container = document.getElementById('test-container');
            container.style.display = 'block';
            for (let i = 0; i < 100; i++) {
                const div = document.createElement('div');
                div.textContent = `Element ${i}`;
                div.style.padding = '5px';
                container.appendChild(div);
            }
            log('â• Added 100 DOM elements');
        }
        
        function removeElements() {
            const container = document.getElementById('test-container');
            container.innerHTML = '';
            container.style.display = 'none';
            log('â– Removed all test elements');
        }
        
        function modifyElements() {
            const container = document.getElementById('test-container');
            const elements = container.children;
            for (let element of elements) {
                element.style.background = `hsl(${Math.random() * 360}, 70%, 80%)`;
            }
            log('âœï¸ Modified element styles');
        }
        
        function causeLayoutShift() {
            const container = document.getElementById('test-container');
            container.style.display = 'block';
            container.style.height = '200px';
            setTimeout(() => {
                container.style.height = '400px';
                log('ğŸ“ Caused layout shift');
            }, 100);
        }
    </script>
</body>
</html>